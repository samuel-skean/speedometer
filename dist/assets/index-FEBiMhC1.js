(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function e(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(o){if(o.ep)return;o.ep=!0;const a=e(o);fetch(o.href,a)}})();(n=>{const i=typeof window<"u"&&typeof window.matchMedia=="function",e={isPwaInstalled(){const t=i&&window.matchMedia("(display-mode: standalone)").matches,o=i&&window.matchMedia("(display-mode: minimal-ui)").matches,a=i&&window.matchMedia("(display-mode: fullscreen)").matches,r=typeof navigator<"u"&&navigator.userAgent||"",h=/iPhone|iPad|iPod/i.test(r),P=typeof navigator<"u"&&"standalone"in navigator&&navigator.standalone===!0,M=typeof window<"u"&&h&&typeof window.innerHeight=="number"&&typeof window.outerHeight=="number"&&Math.abs(window.outerHeight-window.innerHeight)<=2;return!!(t||o||a||P||M)},applyPwaClass(){const t=document.body;t&&(e.isPwaInstalled()?t.classList.add("pwa-installed"):t.classList.remove("pwa-installed"))},setupDisplayModeListener(){if(!i)return;const t=window.matchMedia("(display-mode: standalone)");t&&typeof t.addEventListener=="function"?t.addEventListener("change",e.applyPwaClass):t&&typeof t.addListener=="function"&&t.addListener(e.applyPwaClass)},init(){document.body&&e.applyPwaClass();const t=()=>{e.applyPwaClass(),e.setupDisplayModeListener(),document.addEventListener("visibilitychange",e.applyPwaClass),window.addEventListener("pageshow",e.applyPwaClass),window.addEventListener("orientationchange",e.applyPwaClass),window.addEventListener("resize",e.applyPwaClass)};document.readyState==="interactive"||document.readyState==="complete"?t():document.addEventListener("DOMContentLoaded",t,{once:!0})}};n.PWADetection=e,e.init()})(window);const p=document.getElementById("speed"),f=document.getElementById("unit"),m=document.getElementById("status"),c=document.getElementById("unitToggle"),l={MPH:"mph",KPH:"km/h"},E=2.2369362920544,L=3.6;let d=localStorage.getItem("speed-unit")||l.MPH,u=null;function y(){f&&(f.textContent=d),c&&(c.textContent=d)}function g(n){if(!Number.isFinite(n)||n<0){s("FIXME: Error");return}const i=d===l.MPH?n*E:n*L,e=Math.min(Math.max(i,0),999),t=Math.round(e);p&&(p.textContent=String(t))}function s(n){m&&(m.textContent=n)}function v(n){const{speed:i,accuracy:e}=n.coords;typeof i=="number"&&Number.isFinite(i)&&i>=0&&(u=i,g(i)),typeof e=="number"&&Number.isFinite(e)?s(`Accuracy: Â±${Math.round(e)}m`):s("GPS fix acquired")}function S(n){switch(n.code){case n.PERMISSION_DENIED:s("Location permission denied. Enable it to see speed.");break;case n.POSITION_UNAVAILABLE:s("Location unavailable. Move to open sky for GPS.");break;case n.TIMEOUT:s("Location timeout. Trying again...");break;default:s(`Error: ${n.message}`)}}function w(){y(),c==null||c.addEventListener("click",()=>{d=d===l.MPH?l.KPH:l.MPH,localStorage.setItem("speed-unit",d),y(),u!==null&&g(u)});const n={enableHighAccuracy:!0,maximumAge:1e3,timeout:1e4};"geolocation"in navigator?(s("Requesting GPS..."),navigator.geolocation.watchPosition(v,S,n)):s("Geolocation not supported on this device.")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",w,{once:!0}):w();
